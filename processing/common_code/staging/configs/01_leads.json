{
  "landing_zone_table": "raw_leads",
  "landing_zone_bucket": "raw-data",
  "landing_zone_path": "propwise/raw_leads",
  "target_bucket": "staging",
  "target_path": "processed_leads",
  "target_table": "processed_leads",
  "primary_key": "id",
  "file_format": "parquet",

  "schema_evolution": {
    "mode": "flexible",
    "description": "Controls how schema changes are handled",
    
    "mode_options": {
      "strict": "Only mapped columns allowed, reject unmapped",
      "flexible": "Apply mappings + keep unmapped columns as-is (DEFAULT)",
      "pass_through": "No mappings, ingest all columns as-is"
    },
    
    "unmapped_columns": "keep",
    "unmapped_options": {
      "keep": "Keep new columns as-is (schema expansion friendly)",
      "drop": "Drop new columns (strict schema)"
    },
    
    "missing_columns": "null",
    "missing_options": {
      "error": "Fail job if mapped column is missing from source",
      "warn": "Log warning, skip missing columns",
      "null": "Add missing columns with NULL values (DEFAULT)",
      "skip": "Silently skip missing columns"
    },
    
    "log_schema_drift": true
  },

  "partitions": {
    "1": {
      "col": "lead_created_at",
      "name": "year",
      "type": "int",
      "comment": "Year partition from created_at (100% valid, 78 months, even distribution)"
    },
    "2": {
      "col": "lead_created_at",
      "name": "month",
      "type": "int",
      "comment": "Month partition from created_at"
    }
  },

  "merge_cols": {
    "1": "extraction_time",
    "2": "lead_updated_at"
  },

  "timestamp_cols": {
    "1": {
      "col": "lead_created_at",
      "format": "M/d/yyyy H:mm"
    },
    "2": {
      "col": "lead_updated_at",
      "format": "M/d/yyyy H:mm"
    },
    "3": {
      "col": "date_of_last_contact",
      "format": "M/d/yyyy H:mm"
    },
    "4": {
      "col": "date_of_last_request",
      "format": "M/d/yyyy H:mm"
    },
    "5": {
      "col": "extraction_time",
      "format": "yyyy-MM-dd'T'HH:mm:ss.SSSSSS"
    }
  },

  "mapping": {
    "1": {
      "input_column": "op",
      "input_type": "string",
      "output_column": "op",
      "output_type": "string",
      "comment": "The operation invoked: I = Insert, D = Delete, U = Update."
    },
    "2": {
      "input_column": "extraction_time",
      "input_type": "string",
      "output_column": "extraction_time",
      "output_type": "timestamp",
      "comment": "The datetime the data was extracted from the database & loaded into data lake."
    },
    "3": {
      "input_column": "gpk",
      "input_type": "string",
      "output_column": "gpk",
      "output_type": "string",
      "comment": "Global primary key: id~extraction_timestamp."
    },
    "4": {
      "input_column": "env",
      "input_type": "string",
      "output_column": "env",
      "output_type": "string",
      "comment": "Environment: test, prod, etc."
    },
    "5": {
      "input_column": "region",
      "input_type": "string",
      "output_column": "region",
      "output_type": "string",
      "comment": "Region: local, us-east-1, etc."
    },
    "6": {
      "input_column": "id",
      "input_type": "string",
      "output_column": "lead_id",
      "output_type": "string",
      "comment": "The unique identifier for the lead."
    },
    "7": {
      "input_column": "date_of_last_request",
      "input_type": "string",
      "output_column": "date_of_last_request",
      "output_type": "timestamp",
      "comment": "Date of the last request from the lead."
    },
    "8": {
      "input_column": "buyer",
      "input_type": "string",
      "output_column": "is_buyer",
      "output_type": "boolean",
      "comment": "Whether the lead is a buyer."
    },
    "9": {
      "input_column": "seller",
      "input_type": "string",
      "output_column": "is_seller",
      "output_type": "boolean",
      "comment": "Whether the lead is a seller."
    },
    "10": {
      "input_column": "best_time_to_call",
      "input_type": "string",
      "output_column": "best_time_to_call",
      "output_type": "string",
      "comment": "Preferred time to contact the lead."
    },
    "11": {
      "input_column": "budget",
      "input_type": "string",
      "output_column": "budget",
      "output_type": "float",
      "comment": "Budget amount for the lead."
    },
    "12": {
      "input_column": "created_at",
      "input_type": "string",
      "output_column": "lead_created_at",
      "output_type": "timestamp",
      "comment": "The datetime when the lead was created."
    },
    "13": {
      "input_column": "updated_at",
      "input_type": "string",
      "output_column": "lead_updated_at",
      "output_type": "timestamp",
      "comment": "The datetime when the lead was last updated."
    },
    "14": {
      "input_column": "user_id",
      "input_type": "string",
      "output_column": "agent_id",
      "output_type": "string",
      "comment": "The agent/user ID assigned to the lead."
    },
    "15": {
      "input_column": "location",
      "input_type": "string",
      "output_column": "location",
      "output_type": "string",
      "comment": "Preferred property location."
    },
    "16": {
      "input_column": "date_of_last_contact",
      "input_type": "string",
      "output_column": "date_of_last_contact",
      "output_type": "timestamp",
      "comment": "Date of last contact with the lead."
    },
    "17": {
      "input_column": "status_name",
      "input_type": "string",
      "output_column": "lead_status",
      "output_type": "string",
      "comment": "Current status of the lead."
    },
    "18": {
      "input_column": "commercial",
      "input_type": "string",
      "output_column": "is_commercial",
      "output_type": "boolean",
      "comment": "Whether the lead is for commercial property."
    },
    "19": {
      "input_column": "merged",
      "input_type": "string",
      "output_column": "is_merged",
      "output_type": "boolean",
      "comment": "Whether the lead has been merged."
    },
    "20": {
      "input_column": "area_id",
      "input_type": "string",
      "output_column": "area_id",
      "output_type": "string",
      "comment": "Area identifier."
    },
    "21": {
      "input_column": "compound_id",
      "input_type": "string",
      "output_column": "compound_id",
      "output_type": "string",
      "comment": "Compound/development identifier."
    },
    "22": {
      "input_column": "developer_id",
      "input_type": "string",
      "output_column": "developer_id",
      "output_type": "string",
      "comment": "Developer identifier."
    },
    "23": {
      "input_column": "meeting_flag",
      "input_type": "string",
      "output_column": "has_meeting",
      "output_type": "boolean",
      "comment": "Whether a meeting is scheduled."
    },
    "24": {
      "input_column": "do_not_call",
      "input_type": "string",
      "output_column": "do_not_call",
      "output_type": "boolean",
      "comment": "Do not call flag."
    },
    "25": {
      "input_column": "lead_type_id",
      "input_type": "string",
      "output_column": "lead_type_id",
      "output_type": "string",
      "comment": "Lead type identifier."
    },
    "26": {
      "input_column": "customer_id",
      "input_type": "string",
      "output_column": "customer_id",
      "output_type": "string",
      "comment": "Customer identifier."
    },
    "27": {
      "input_column": "method_of_contact",
      "input_type": "string",
      "output_column": "contact_method",
      "output_type": "string",
      "comment": "Method of contact (phone, email, etc.)."
    },
    "28": {
      "input_column": "lead_source",
      "input_type": "string",
      "output_column": "lead_source",
      "output_type": "string",
      "comment": "Source of the lead (google, facebook, etc.)."
    },
    "29": {
      "input_column": "campaign",
      "input_type": "string",
      "output_column": "campaign",
      "output_type": "string",
      "comment": "Marketing campaign name."
    },
    "30": {
      "input_column": "lead_type",
      "input_type": "string",
      "output_column": "lead_type",
      "output_type": "string",
      "comment": "Type of lead (Primary, Secondary, etc.)."
    }
  }
}

